{% extends "bookstore/base.html" %}
{% block content %}
<div class="container animate-fade-in">
    <div style="text-align:center; margin-bottom:2rem;">
        <h1 style="font-weight:400; color:var(--text-primary);">ğŸ“¦ æˆ‘çš„è®¢å•</h1>
        <p style="color:var(--text-secondary);">æŸ¥çœ‹å†å²è®¢å•ä¸æ”¯ä»˜çŠ¶æ€</p>
    </div>

    {% if orders_with_details %}
    <div class="card">
        <div class="card-body">
            <div style="overflow-x:auto;">
                <table style="width:100%; border-collapse:collapse;">
                    <thead style="background:var(--secondary-bg);">
                        <tr>
                            <th style="padding:1rem; text-align:left;">è®¢å•å·</th>
                            <th style="padding:1rem; text-align:center;">ä¸‹å•æ—¶é—´</th>
                            <th style="padding:1rem; text-align:center;">åº”ä»˜é‡‘é¢</th>
                            <th style="padding:1rem; text-align:center;">å®ä»˜é‡‘é¢</th>
                            <th style="padding:1rem; text-align:center;">ä»˜æ¬¾çŠ¶æ€</th>
                            <th style="padding:1rem; text-align:center;">è®¢å•çŠ¶æ€</th>
                            <th style="padding:1rem; text-align:center;">æ“ä½œ</th>
                        </tr>
                    </thead>
                    <tbody>
                        {% for item in orders_with_details %}
                        <tr style="border-bottom:1px solid var(--border);">
                            <td style="padding:1rem; font-weight:600; color:var(--text-primary);">{{ item.order.orderno }}</td>
                            <td style="padding:1rem; text-align:center;">{{ item.order.orderdate|date:"Y-m-d H:i" }}</td>
                            <td style="padding:1rem; text-align:center; font-weight:700;">Â¥{{ item.order.totalamount|floatformat:2 }}</td>
                            <td style="padding:1rem; text-align:center;">Â¥{{ item.order.actualpaid|floatformat:2 }}</td>
                            <td style="padding:1rem; text-align:center;">
                                {% if item.order.status == 4 %}
                                  <span style="color: var(--text-secondary);">å·²é€€æ¬¾</span>
                                {% elif item.order.paymentstatus == 0 %}
                                  <span style="color: var(--error);">âŒ æœªæ”¯ä»˜</span>
                                {% elif item.order.paymentstatus == 1 %}
                                  <span style="color: var(--success);">âœ“ å·²æ”¯ä»˜</span>
                                {% elif item.order.paymentstatus == 2 %}
                                  <span style="color: var(--warning);">â³ å¾…è¡¥æ¬¾</span>
                                {% elif item.order.paymentstatus == 3 %}
                                  <span style="color: var(--text-secondary);">å·²é€€æ¬¾</span>
                                {% endif %}
                            </td>
                            <td style="padding:1rem; text-align:center;">
                                {% if item.order.status == 0 %}
                                  <span style="color: var(--warning);">å·²ä¸‹å•</span>
                                {% elif item.order.status == 1 %}
                                  <span style="color: var(--accent);">å·²å‘è´§</span>
                                {% elif item.order.status == 2 %}
                                  <span style="color: var(--success);">å·²å®Œæˆ</span>
                                {% elif item.order.status == 4 %}
                                  <span style="color: var(--text-secondary);">å·²å–æ¶ˆ</span>
                                {% endif %}
                            </td>
                            <td style="padding:1rem; text-align:center;">
                                <a href="{% url 'bookstore:order_detail' item.order.orderid %}" class="btn btn-secondary" style="padding:0.4rem 0.8rem;">æŸ¥çœ‹è¯¦æƒ…</a>
                                {% if item.order.paymentstatus == 0 and item.order.status != 4 %}
                                  <a href="{% url 'bookstore:order_detail' item.order.orderid %}" class="btn btn-primary" style="padding:0.4rem 0.8rem; margin-left:0.5rem;">ğŸ’³ å»æ”¯ä»˜</a>
                                {% endif %}
                            </td>
                        </tr>
                        {% endfor %}
                    </tbody>
                </table>
            </div>
        </div>
    </div>
    {% else %}
    <div class="card">
        <div class="card-body" style="text-align:center; padding:3rem;">
            <div style="font-size:3rem; margin-bottom:1rem;">ğŸ“­</div>
            <div style="color:var(--text-secondary);">æš‚æ— è®¢å•è®°å½•</div>
            <p style="margin-top:1rem;"><a href="{% url 'bookstore:index' %}" class="btn btn-primary">å»è´­ç‰©</a></p>
        </div>
    </div>
    {% endif %}

    <div style="margin-top:1.5rem; text-align:center;">
        <a href="{% url 'bookstore:index' %}" class="btn btn-secondary">è¿”å›é¦–é¡µ</a>
    </div>
</div>
{% endblock %}





