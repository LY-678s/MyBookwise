# æ–°çš„é€æ”¯é€»è¾‘è¯´æ˜

## ğŸ“Š CurrentOverdraftï¼ˆå½“å‰é€æ”¯é‡‘é¢ï¼‰è®¡ç®—

### è®¡ç®—å…¬å¼

```
CurrentOverdraft = è´Ÿä½™é¢éƒ¨åˆ† + æœªä»˜æ¬¾è®¢å•æ€»é¢
```

**å…·ä½“ï¼š**
```python
è´Ÿä½™é¢éƒ¨åˆ† = abs(min(Balance, 0))  # ä½™é¢ä¸ºè´Ÿæ—¶çš„ç»å¯¹å€¼
æœªä»˜æ¬¾è®¢å•æ€»é¢ = SUM(æœªä»˜æ¬¾è®¢å•çš„TotalAmount)

CurrentOverdraft = è´Ÿä½™é¢éƒ¨åˆ† + æœªä»˜æ¬¾è®¢å•æ€»é¢
```

---

## ğŸ’¡ ç¤ºä¾‹åœºæ™¯

### åœºæ™¯1ï¼šæš‚ç¼“ä»˜æ¬¾è®¢å•

**æå››ï¼ˆ4çº§ä¼šå‘˜ï¼‰ï¼š**
- Balance = 2422.80å…ƒ
- åˆ›å»ºæš‚ç¼“ä»˜æ¬¾è®¢å•ï¼Œé‡‘é¢71.20å…ƒ
- **ç»“æœï¼š**
  - Balance = 2422.80å…ƒï¼ˆä¸å˜ï¼‰
  - CurrentOverdraft = 0 + 71.20 = **71.20å…ƒ** â­
  - å¯ç”¨é€æ”¯é¢åº¦ = 1000 - 71.20 = 928.80å…ƒ

### åœºæ™¯2ï¼šé€æ”¯è´­ä¹°ï¼ˆä½™é¢ä¸è¶³ï¼‰

**æå››ï¼š**
- Balance = 100å…ƒ
- ç«‹å³ä»˜æ¬¾è´­ä¹°300å…ƒçš„ä¹¦
- **ç»“æœï¼š**
  - Balance = 100 - 300 = **-200å…ƒ**
  - CurrentOverdraft = 200 + 0 = **200å…ƒ** â­
  - TotalSpent += 300

### åœºæ™¯3ï¼šæ—¢æœ‰è´Ÿä½™é¢åˆæœ‰æœªä»˜æ¬¾è®¢å•

**æå››ï¼š**
- Balance = -50å…ƒ
- æœ‰æœªä»˜æ¬¾è®¢å•200å…ƒ
- **ç»“æœï¼š**
  - CurrentOverdraft = 50 + 200 = **250å…ƒ** â­
  - å¯ç”¨é€æ”¯é¢åº¦ = 1000 - 250 = 750å…ƒ

### åœºæ™¯4ï¼šæ”¯ä»˜æœªä»˜æ¬¾è®¢å•

**æå››ï¼ˆBalance=100ï¼Œæœªä»˜æ¬¾è®¢å•71.20ï¼‰ï¼š**
- CurrentOverdraft = 0 + 71.20 = 71.20å…ƒ
- æ”¯ä»˜è®¢å•71.20å…ƒ
- **ç»“æœï¼š**
  - Balance = 100 - 71.20 = 28.80å…ƒ
  - CurrentOverdraft = 0 + 0 = **0å…ƒ** â­
  - TotalSpent += 71.20

### åœºæ™¯5ï¼šå¿è¿˜é€æ”¯ï¼ˆæ”¯ä»˜æ‰€æœ‰æœªä»˜æ¬¾è®¢å•ï¼‰

**æå››ï¼ˆBalance=-50ï¼Œæœªä»˜æ¬¾è®¢å•2ä¸ªå…±200å…ƒï¼‰ï¼š**
- CurrentOverdraft = 50 + 200 = 250å…ƒ
- ç‚¹å‡»"å¿è¿˜é€æ”¯"
- **æ“ä½œï¼š**
  1. æ”¯ä»˜è®¢å•1ï¼ˆ100å…ƒï¼‰â†’ Balance = -150
  2. æ”¯ä»˜è®¢å•2ï¼ˆ100å…ƒï¼‰â†’ Balance = -250
  3. è¡¥è¶³è´Ÿä½™é¢250å…ƒ â†’ Balance = 0
- **ç»“æœï¼š**
  - Balance = **0å…ƒ**
  - CurrentOverdraft = **0å…ƒ**
  - TotalSpent += 250å…ƒï¼ˆ200è®¢å•+50è´Ÿä½™é¢ï¼‰
  - å¯èƒ½å‡çº§

---

## ğŸ”„ å…³é”®ä¸šåŠ¡é€»è¾‘

### ä¸‹å• - æš‚ç¼“ä»˜æ¬¾

```python
1. æ£€æŸ¥å¯ç”¨é€æ”¯é¢åº¦
   available = OverdraftLimit - CurrentOverdraft
   
2. å¦‚æœ OrderAmount > available:
   æç¤ºï¼šè¶…å‡ºé€æ”¯é¢åº¦
   
3. åˆ›å»ºè®¢å•ï¼ˆPaymentStatus=0ï¼‰

4. æ›´æ–°CurrentOverdraftï¼ˆå¢åŠ è®¢å•é‡‘é¢ï¼‰
   CurrentOverdraft += OrderAmount
```

### æ”¯ä»˜æœªä»˜æ¬¾è®¢å•

```python
1. æ‰£æ¬¾ï¼šBalance -= OrderAmount

2. æ›´æ–°è®¢å•ï¼š
   ActualPaid = TotalAmount
   PaymentStatus = 1

3. æ›´æ–°å®¢æˆ·ï¼š
   TotalSpent += OrderAmount
   CurrentOverdraft = calculate_current_overdraft(customer)  # é‡æ–°è®¡ç®—
```

### å¿è¿˜é€æ”¯

```python
1. æ”¯ä»˜æ‰€æœ‰æœªä»˜æ¬¾è®¢å•ï¼š
   for order in unpaid_orders:
       Balance -= order.TotalAmount
       TotalSpent += order.TotalAmount
       order.PaymentStatus = 1

2. è¡¥è¶³è´Ÿä½™é¢ï¼š
   if Balance < 0:
       deficit = abs(Balance)
       Balance = 0
       TotalSpent += deficit

3. é‡æ–°è®¡ç®—ï¼š
   CurrentOverdraft = 0  # åº”è¯¥ä¸º0
```

### å……å€¼

```python
Balance += å……å€¼é‡‘é¢
CurrentOverdraft = calculate_current_overdraft(customer)  # é‡æ–°è®¡ç®—
```

---

## âœ… ä¼˜åŠ¿

1. **é€»è¾‘æ¸…æ™°**ï¼šé€æ”¯ = æ¬ æ¬¾ + æœªä»˜è®¢å•
2. **å®æ—¶å‡†ç¡®**ï¼šæ¯æ¬¡æ“ä½œéƒ½é‡æ–°è®¡ç®—
3. **ç”¨æˆ·å‹å¥½**ï¼š
   - æš‚ç¼“ä»˜æ¬¾è®¢å•ä¼šæ˜¾ç¤ºå ç”¨é¢åº¦
   - å¿è¿˜é€æ”¯ä¼šä¸€æ¬¡æ€§å¤„ç†æ‰€æœ‰æ¬ æ¬¾
4. **é˜²æ­¢è¶…é™**ï¼šæš‚ç¼“ä»˜æ¬¾å‰æ£€æŸ¥æ€»é€æ”¯é¢åº¦

---

## ğŸ§ª æµ‹è¯•åœºæ™¯

### æµ‹è¯•1ï¼šæš‚ç¼“ä»˜æ¬¾
1. æå››ä¸‹å•71.20å…ƒï¼Œé€‰æ‹©"æš‚ç¼“ä»˜æ¬¾"
2. CurrentOverdraftåº”è¯¥å˜ä¸º71.20
3. å¯ç”¨é¢åº¦ = 1000 - 71.20 = 928.80

### æµ‹è¯•2ï¼šå†åˆ›å»ºæš‚ç¼“ä»˜æ¬¾è®¢å•
1. æå››å†ä¸‹å•200å…ƒï¼Œé€‰æ‹©"æš‚ç¼“ä»˜æ¬¾"
2. CurrentOverdraft = 71.20 + 200 = 271.20
3. å¯ç”¨é¢åº¦ = 1000 - 271.20 = 728.80

### æµ‹è¯•3ï¼šæ”¯ä»˜ä¸€ä¸ªæœªä»˜æ¬¾è®¢å•
1. æå››æ”¯ä»˜71.20å…ƒçš„è®¢å•
2. Balance = 2422.80 - 71.20 = 2351.60
3. CurrentOverdraft = 0 + 200 = 200ï¼ˆè¿˜æœ‰200çš„æœªä»˜æ¬¾è®¢å•ï¼‰
4. TotalSpent = 5077.20 + 71.20 = 5148.40

### æµ‹è¯•4ï¼šå¿è¿˜é€æ”¯
1. ç‚¹å‡»"å¿è¿˜é€æ”¯"
2. æ”¯ä»˜å‰©ä½™çš„200å…ƒè®¢å•
3. Balance = 2351.60 - 200 = 2151.60
4. CurrentOverdraft = 0
5. TotalSpent = 5148.40 + 200 = 5348.40

---

**æ–°é€»è¾‘æ›´ç¬¦åˆçœŸå®ä¸šåŠ¡åœºæ™¯ï¼** ğŸ¯

