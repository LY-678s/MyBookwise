# 数据库课设——网上图书管理系统
以下是主要功能模块测试流程示例
## 顾客端
### 1.注册
通过账号密码注册，并可以引导输入个人详细信息——地址、联系方式等。
### 2.搜索
书名/关键字/isbn
### 3.购物车添加
可以调整数量，点击即可成功添加至购物车。
当输入数量大于库存时，会提示需要输入<=库存的数
### 4.下单与付款（不涉及缺货等特殊情况）
（注意为了简单，我没有在有些新创建的账号里面补齐Totalspent应该有的历史订单）
这里字段的显示，分别关注主页、购物车、动作消息提示以及个人账户
#### 4.1 信用等级LevelID=1 OR 2，不享受先享后付，只能使用余额支付
设置：
-- 客户数据
CustomerID=1, TotalSpent=285.30, Balance=714.70, LevelID=1
CustomerID=4, TotalSpent=1300.00, Balance=2000.00, LevelID=2
-- 图书数据
ISBN='978-7-115-48935-5', StockQty=40, MinStockLimit=10
创建订单：
ISBN='978-7-115-48935-5', quantity=5
预期：
- 下单时，totalspent自动增加，balance减少
- 当明细字段isshipped全部改为1，订单status改为1
#### 4.2 信用等级LevelID=3 OR 4 OR 5，享受先享后付，能选择使用余额支付或信用支付
CustomerID=5, TotalSpent=2022.15, Balance=3000.00, LevelID=3
CustomerID=2, TotalSpent=1300.00, Balance=2000.00, LevelID=4
CustomerID=3, TotalSpent=285.30, Balance=714.70, LevelID=5
这里建议自行根据用户额度和信用额度选择数据（因为前面customer数据可能后期会变动，这里确定哪个具体数据无意义。）
1. 选择未超余额和信用余额的数据
2. 选择不超过余额但完整金额超过信用余额的数据
3. 选择超过余额但多出部分不超过信用余额的数据，且完整金额超过信用余额。
4. 选择超过余额和多出部分超过信用余额的数据
5. 选择超过余额但完整金额不超过信用余额的数据
预期：
1. 
使用余额付款
  - 下单时，totalspent自动增加，balance减少
  - 当明细字段isshipped全部改为1，订单status改为1
使用信用额度付款
  - 下单时，totalspent自动增加，usedcredit自动增加
  - 当明细字段isshipped全部改为1，订单status改为1
2. 只能使用余额付款
情况同1中
3. 只能先使用全部余额，不足从信用额度扣款。
  下单时点击信用扣款会
  - 下单时，totalspent自动增加，usedcredit自动增加，balance自动减少
  - 其余同上
4. 无论勾选哪种都会提示错误，无法下单
5. 先使用全部余额再使用信用余额和直接使用信用余额付款都OK
具体情况同上类似例子。
#### 5.信用升级
CustomerID=5, TotalSpent=2022.15, Balance=3000.00, LevelID=3
选择
ISBN='978-7-302-51123-4', quantity=12, MinStockLimit=12
ISBN='978-7-111-54425-7', quantity=10, MinStockLimit=12
预期：
totalamount=2181.10，等级由3升至4
#### 6.我的订单
所有的历史订单详情都可以在此查看，具体如下
暂时无法在飞书文档外展示此内容
未全额支付的订单可以在详情页选择全部还款。
在收到货后可以确认订单以彻底完成整个订单。
#### 7.我的主页
可以修改密码，联系方式、地址
可以充值。
可以查看账户的完整信息——余额，信用等级，信用余额等。

## 管理员端
对于订单，创建在顾客端，管理员端只能手动修改其状态为已下单、已发货，不允许创建订单。
### 1. 缺货登记和采购单
- 当顾客端订单使得库存低于最小限制时，将在数据库中自动生成缺货登记和采购单
- 当采购单状态为已到货入库时，缺货单要自动将status标记为1（已处理），且图书库存也自动补上
- 可以手动添加采购记录和缺货登记
- 可搜索
### 2. 订单
- 可以修改订单状态为已发货、已完成和已取消
- 可搜索
- 禁止将已取消订单重新打开，否则抛出错误提示，不允许此类行为
### 3. 客户、图书、图书作者、信用等级规则、供应商图书对应信息和供应商信息管理
均可实现增删改查
1. 客户：包括客户名、密码、balance、levelid等详细信息的修改
2. 图书主数据管理：除基础信息（书号、书名、出版社、价格）外，还需支持复杂的图书关系。
3. 图书-作者表：通过“作者序位”字段管理最多四位有序作者；通过“丛书编号”关联同一丛书下的不同分册；
4. 信用等级规则：规定信用等级规则
5. 供货信息管理：维护供应商与图书的关联信息，包括 供应价格、最新供货日期等。理想情况下，系统应能为供应商提供一个门户，让其自行更新可供货的书目信息。
6. 供应商基本信息：详细记录供应商名称、联系人、地址、银行账户等，并可通过“合作状态”字段管理活跃或已终止合作的供应商。
